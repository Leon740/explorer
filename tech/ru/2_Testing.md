# Тестирование

## Зачем нужно тестирование

### 1. Предсказуемость

Тесты подтверждают, что система ведёт себя предсказуемо и соответствует ожидаемому поведению:

- функции выполняют именно то, что от них ожидается
- изменения не ломают уже существующий функционал
- случайные сценарии и граничные случаи не приводят к поломке системы

Вносить обновления без тестов - небезопасно.

### 2. Устойчивость к непредсказуемым ситуациям

Тестирование позволяет проверить поведение системы в условиях неопределённости:

- высокая нагрузка (например, тысячи пользователей одновременно)
- граничные случаи
- невалидные входные данные
- неожиданные комбинации состояний

### 3. Проверка архитектуры

Тестирование - это лакмус архитектуры.

Если:

- компоненты сложно тестировать
- зависимости трудно изолировать

значит, проблема находится в архитектуре, а не в тестах.  
Тесты лишь делают эту проблему видимой.

Особенно это заметно в дизайн-системах:  
если компоненты неудобно тестировать в приложениях-потребителях, архитектура требует пересмотра.

### 4. Тесты как документация

Тесты должны выступать документацией.

Хороший тест:

- описывает как система должна работать
- фиксирует допустимые сценарии
- служит живым контрактом поведения

> Тесты - это спецификация, которую невозможно проигнорировать.

---

## Test Driven Development (TDD)

### Проблема

Система ведёт себя некорректно.

- тратятся часы, дни или недели на поиск причины
- ошибка может скрываться в одной небольшой функции
- регрессии обнаруживаются слишком поздно

### Решение

Следовать подходу Test Driven Development.

---

## Как выглядит процесс TDD

1. Анализ требований  
   Понимание задачи и проектирование системы.

2. Выбор минимальной фичи  
   Самый маленький осмысленный шаг.

3. Написание failing test  
   Тест должен падать, так как ожидаемое поведение ещё не реализовано.

4. Минимальная реализация  
   Создаётся базовый код, позволяющий тесту выполняться.

5. Реализация функционала  
   Поведение доводится до ожидаемого состояния.

6. Покрытие граничных случаев  
   Добавляются проверки граничных и неочевидных сценариев.

7. Рефакторинг  
   Улучшение структуры кода без изменения поведения.

Цикл повторяется.

---

## Как писать хорошие тесты

### 1. Тест читается как проза

- осмысленные имена
- понятная структура
- минимальный шум

Если тест сложно читать - он не выполняет свою функцию.

### 2. Один тест - одна ответственность

Каждый тест проверяет одно конкретное поведение.  
Причина падения должна быть очевидной.

### 3. Изоляция

- отсутствие внешних зависимостей
- отсутствие побочных эффектов
- отсутствие состояния, влияющего на другие тесты

Тест должен быть как чистая функция.

### 4. Группировка

Схожие тесты логически группируются:

- по модулю
- по сценарию
- по контексту

### 5. Arrange - Act - Assert

Вспомогательные комментарии, помогающие структурировать тест.

```ts
// Arrange
// Act
// Assert
```
